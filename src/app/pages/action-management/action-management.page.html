@if (isMenuOpen) {
  <ion-backdrop [visible]="true"> </ion-backdrop>
}
<app-header headerTitle="Action management" [isDefaultHref]="true"></app-header>

<ion-content [fullscreen]="true" color="background">
  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <div
          class="max-w-full m-5 mt-8 rounded-[8px] bg-white shadow-[0px_0px_6px_0px_#0000002E]"
        >
          <div class="topSegment max-w-full mx-auto p-6 border-b-[2px]">
            <!-- Segment tabs -->
            <ion-segment
              class="p-2"
              [value]="segment"
              [scrollable]="true"
              (ionChange)="handleTopSegmentChange($event)"
            >
              <ion-segment-button value="finding">
                <div
                  class="segment-change ion-justify-content-center rounded-full"
                >
                  <ion-icon
                    class="p-4 h-[32px] w-[32px] image"
                    src="../../../../../assets/segment-icons/sim.svg"
                  >
                  </ion-icon>
                  <ion-text
                    color="textwhite"
                    class="ion-text-center hidden-content"
                  >
                    Findings
                  </ion-text>
                </div>
              </ion-segment-button>

              <ion-segment-button value="action">
                <div class="backg">
                  <div
                    class="segment-change ion-justify-content-center rounded-full"
                  >
                    <ion-icon
                      class="p-4 h-[32px] w-[32px] image"
                      src="../../../../../assets/segment-icons/sim.svg"
                    >
                    </ion-icon>
                    <ion-text
                      color="textwhite"
                      class="ion-text-center hidden-content"
                    >
                      Actions
                    </ion-text>
                  </div>
                </div>
              </ion-segment-button>
            </ion-segment>
          </div>

          <!-- segment container -->
          <div class="max-w-full mx-auto p-4">
            @switch (segment) {
              @case ("finding") {
                <div
                  style="display: flex; justify-content: center"
                  class="nestedToggle max-w-full mx-auto border-b-[1px]"
                >
                  <ion-segment
                    class="pt-2 pl-2 pr-2 mt-10"
                    [value]="findingToggleSegment"
                    style="width: 40%"
                    (ionChange)="handleFindingNestedSegmentChange($event)"
                  >
                    <ion-segment-button
                      class="todoToggle"
                      value="findingTodoToggle"
                    >
                      <ion-label>To do</ion-label>
                    </ion-segment-button>
                    <ion-segment-button
                      class="followUpToggle"
                      value="findingfollowUpToggle"
                    >
                      <ion-label>Follow up</ion-label>
                    </ion-segment-button>
                  </ion-segment>
                </div>

                <!-- Toggle segment container -->
                <div class="max-w-full mx-auto">
                  @switch (findingToggleSegment) {
                    @case ("findingTodoToggle") {
                      <div>
                        <ion-row class="mt-3">
                          <ion-col size="6" class="mt-2 font-bold text-[20px]">
                            Findings assigned to me (5)
                          </ion-col>
                          <ion-col size="6" class="flex justify-end">
                            <ion-button
                              fill="outline"
                              shape="round"
                              color="primary"
                              (click)="filterFindings($event)"
                            >
                              <div class="flex justify-between mx-auto">
                                <ion-label
                                  class="flex items-center justify-center"
                                  style="color: #3cb4aa; font-weight: bold"
                                >
                                  Filter (2)
                                  <ion-icon
                                    class="h-[20px] w-[20px] ml-2"
                                    slot="icon-only"
                                    src="../../../assets/Filter.svg"
                                  ></ion-icon>
                                </ion-label>
                              </div>
                            </ion-button>
                          </ion-col>
                        </ion-row>
                      </div>
                      <ion-row size="12">
                        <ion-col size="6" class="max-w-full">
                          <app-findings-card></app-findings-card>
                          <app-findings-card></app-findings-card>
                        </ion-col>
                        <ion-col size="6" class="max-w-full">
                          <app-findings-card></app-findings-card>
                          <app-findings-card></app-findings-card>
                        </ion-col>
                      </ion-row>
                    }
                    @case ("findingfollowUpToggle") {
                      <div>
                        <ion-row class="mt-3">
                          <ion-col size="6" class="mt-2 font-bold text-[20px]">
                            Findings assigned to me (5)
                          </ion-col>
                          <ion-col size="6" class="flex justify-end">
                            <ion-button
                              fill="outline"
                              shape="round"
                              color="primary"
                              (click)="filterFindings($event)"
                            >
                              <div class="flex justify-between mx-auto">
                                <ion-label
                                  class="flex items-center justify-center"
                                  style="color: #3cb4aa; font-weight: bold"
                                >
                                  Filter (2)
                                  <ion-icon
                                    class="h-[20px] w-[20px] ml-2"
                                    slot="icon-only"
                                    src="../../../assets/Filter.svg"
                                  ></ion-icon>
                                </ion-label>
                              </div>
                            </ion-button>
                          </ion-col>
                        </ion-row>
                      </div>
                      <ion-row size="12">
                        <ion-col size="6">
                          <app-findings-card></app-findings-card>
                          <app-findings-card></app-findings-card>
                        </ion-col>
                        <ion-col size="6">
                          <app-findings-card></app-findings-card>
                          <app-findings-card></app-findings-card>
                        </ion-col>
                      </ion-row>
                    }
                  }
                </div>
              }
              @case ("action") {
                <div
                  style="display: flex; justify-content: center"
                  class="nestedToggle max-w-full mx-auto border-b-[1px]"
                >
                  <ion-segment
                    class="pt-2 pl-2 pr-2 mt-10"
                    [value]="actionToggleSegment"
                    style="width: 40%"
                    (ionChange)="handleActionNestedSegmentChange($event)"
                  >
                    <ion-segment-button
                      class="todoToggle"
                      value="actiontodoToggle"
                    >
                      <ion-label>To do</ion-label>
                    </ion-segment-button>
                    <ion-segment-button
                      class="followUpToggle"
                      value="actionfollowUpToggle"
                    >
                      <ion-label>Follow up</ion-label>
                    </ion-segment-button>
                  </ion-segment>
                </div>
                <!-- Toggle segment container -->
                <div class="max-w-full mx-auto p-4">
                  @switch (actionToggleSegment) {
                    @case ("actiontodoToggle") {
                      <div>Action todo</div>
                    }
                    @case ("actionfollowUpToggle") {
                      <div>Action follow up</div>
                    }
                  }
                </div>
              }
            }
          </div>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
<app-action-management-modal
  [isMenuOpen]="isMenuOpen"
  (isMenuToggleOpen)="filterFindings($event)"
>
</app-action-management-modal>
